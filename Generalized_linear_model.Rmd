---
output:
  html_document:
    code_folding: hide
urlcolor: blue
---

```{r child = 'Knitr_setup.Rmd'}
```

# Generalized linear model (GLM)

Generalized linear models (GLMs) are to be seen as a flexible extension of ordinary linear regression models. They are useful when dealing with response variables that have an error distribution that is not normally distributed, i.e. the Gaussian distribution. In this chapter we will dive into our dataset and look at two possible GLMs, to see which insights we can gather from our data using them. We will take a look at the Poisson regression model and the Binomial regression model.


Source: https://en.wikipedia.org/wiki/Generalized_linear_model


## Poisson

The Poisson regression model can be used to look at count data. Some interesting count data we can look at in our data set is: 

- Peak concurrent users: Which factors contribute to a high peak of concurrent users?
- DLC count: DLC - downloadable content represents extra content in form of new missions, maps or items, usually released after the game has launched. We can try and find out which types of games tend to have more DLC.
- Achievements


ChatGPT: (((The key assumption of a Poisson distribution is that the mean is equal to the variance. If this assumption is violated (i.e., if there is overdispersion or underdispersion in your data), you might need to consider a different model, such as Negative Binomial regression.)))

ChatGPT: ((When using the Poisson model with count data, there are several assumptions and considerations you need to keep in mind:

Mean equals variance: The Poisson distribution assumes that the mean is equal to the variance. This is known as equidispersion. If the variance is greater than the mean, it’s called overdispersion, and if it’s less than the mean, it’s called underdispersion. Both of these situations can lead to inefficient and biased estimates.

Independence of events: The Poisson model assumes that the events (counts) are independent of each other. If this assumption is violated, it can lead to biased estimates.

Rate of occurrence is constant: The Poisson model assumes that the rate at which events occur is constant over time or space.

No simultaneous events: The Poisson model assumes that two events cannot occur at exactly the same instant.

Appropriate offset variable: If you’re modeling rates rather than counts, you need to include an appropriate offset variable in your model.

Zero inflation: Count data often have more zeros than expected under a Poisson distribution. This is known as zero inflation and can lead to biased estimates.

Large counts: The Poisson model works best with large counts. With small counts, the distribution becomes skewed and the model may not fit well.))


((Prose))

To fit a Poisson Model in R we will use the glm() function, where we can specify the distribution to be used with family = "poisson".

###DLC

Let us first take a look at what influences the DLC.count variable. We want to look at which variables lead to higher amounts of DLC. In recent years DLC has come under fire, for developers being lazy, trying to perform cash grabs by withholding content on release in order to release it as DLC later down the road.

```{r}

column.classes <- c(Release.date = "Date")
games.clean <- read.csv('data/games_clean.csv', colClasses = column.classes)


#release date crashes the model, because it must first be converted, however is it count data?
dlc.model1 <- glm(DLC.count ~ Price + Metacritic.score + User.score + Positive + Negative, family = "poisson", data = games.clean)
summary(dlc.model1)


```
Interpreting the summary is not straightforward ((...why...))
However we can see that an increase in the DLC count variable is correlated to less positive reviews, hinting at our assumption from earlier that games with more DLC are rated worse.


((boxplot to see if data is even poisson))

Next we will try and look at what variables could influence the peak concurrent users (Peak CCU).
This is a metric 

```{r}
ccu.model2 <- glm(Peak.CCU ~  Price + Metacritic.score + Average.playtime.two.weeks, family = "poisson", data = games.clean)
summary(ccu.model2)
```



## Binomial

This dataset contains a few interesting areas to apply a binomial model.
PC games are usually developed for Windows, with Mac and Linux operating systems considered second rate.

Let us look at what predictors could be relevant to see if a game supports Linux or not.
Applying the following binomial logistic regression 

```{r}
#data preparation for binomial model


# 2. convert release date to numeric value for the model

ref.date <- as.Date("2000-01-01")
games.clean$Release.date <- as.numeric(games.clean$Release.date - ref.date)
```



```{r}

#model >> developers is too much data
linux.model3 <- glm(Linux ~ Release.date + Metacritic.score + Price, family = "binomial", data = games.clean)
```


```{r}

##Playground binomial > to be deleted
sum(is.na(games.clean$Release.date))
sum(is.na(games.clean$Linux))
table(games.clean$Linux)
```



